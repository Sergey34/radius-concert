<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>Радиус Концерт - Статьи</title>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">


    <link href="/css/open-iconic-bootstrap.min.css" rel="stylesheet">
    <link href="/css/animate.css" rel="stylesheet">

    <link href="/css/owl.carousel.min.css" rel="stylesheet">
    <link href="/css/owl.theme.default.min.css" rel="stylesheet">
    <link href="/css/magnific-popup.css" rel="stylesheet">

    <link href="/css/aos.css" rel="stylesheet">

    <link href="/css/ionicons.min.css" rel="stylesheet">

    <link href="/css/bootstrap-datepicker.css" rel="stylesheet">
    <link href="/css/jquery.timepicker.css" rel="stylesheet">


    <link href="/css/flaticon.css" rel="stylesheet">
    <link href="/css/icomoon.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">


    <!-- include summernote css/js -->
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.css" rel="stylesheet">

</head>
<body>

<div th:insert="fragments/navbar.html"/>
<!-- END nav -->
<div class="hero-wrap" style="background-image: url('/images/bg_3.jpg');">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text d-flex align-itemd-center justify-content-center">
            <div class="col-md-9 ftco-animate text-center d-flex align-items-end justify-content-center">
                <div class="text">
                    <h1 class="mb-4 bread">Создай Контент</h1>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="ftco-section ftco-degree-bg">
    <div class="container">
        <div class="row">

            <div class="col-lg-8 ftco-animate">
                <div class="search-form">
                    <div class="form-group">
                        <input id="title" class="form-control" placeholder="Заголовок" type="text">
                    </div>
                </div>

                <input id="mainImege" class="form-control" placeholder="Логотип" type="text">

                <textarea id="preview" class="form-control" placeholder="Превью" rows="3"></textarea>

                <div id="summernote"><p>Место для статьи</p></div>
                <a class="btn btn-primary py-5 py-md-3 px-4 align-self-stretch d-block" href="#" id="search"
                   onclick="createBlog();">
                    <span>Сохранить</span>
                </a>
            </div> <!-- .col-md-8 -->
            <div class="col-lg-4 sidebar ftco-animate pl-md-5">
                <div class="sidebar-box">
                    <div class="search-form">
                        <div class="form-group">
                            <span class="icon fa fa-search"></span>
                            <input id="add_tag" class="form-control" placeholder="Добавить тег" type="text">
                        </div>
                    </div>
                </div>

                <div class="sidebar-box ftco-animate">
                    <h3>Облако тегов</h3>
                    <div class="tagcloud" id="tags">

                    </div>
                </div>
            </div>
        </div>
    </div>
</section> <!-- .section -->

<div th:insert="fragments/footer.html"/>


<!-- loader -->
<div th:insert="fragments/loader.html"/>


<script src="/js/jquery.min.js"></script>
<script src="/js/jquery-migrate-3.0.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.easing.1.3.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.stellar.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/aos.js"></script>
<script src="/js/jquery.animateNumber.min.js"></script>
<script src="/js/bootstrap-datepicker.js"></script>
<script src="/js/scrollax.min.js"></script>
<script src="/js/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.js"></script>


<script>
$(document).ready(function() {
  $('#summernote').summernote({
    height: 500,                 // set editor height
    minHeight: null,             // set minimum height of editor
    maxHeight: null,             // set maximum height of editor
    focus: true                  // set focus to editable area after initializing summernote
  });
});

function createBlog(){
  const content = $('#summernote').summernote('code');
  const [id] = window.location.href.split('/').slice(5, 6);
  const body = {
    title: $('#title').val(),
    mainImege: $('#mainImege').val(),
    preview: $('#preview').val(),
    content: content,
    event: id,
    tags: $('.tag-cloud-link').map(function() { return this.text; }).get()
  }

  $.ajax('/api/blogs', {
    data : JSON.stringify(body),
    contentType : 'application/json',
    type : 'POST'
  })

  console.log(body);
}

function addTag(name){
  $('#tags').append(`<a class="tag-cloud-link" href="/events/tags/${name}">${name}</a>`);
}

$("#add_tag").keyup(function(event) {
    if (event.keyCode === 13) {
        addTag($("#add_tag").val());
        $("#add_tag").val("");
    }
});



</script>
</body>
</html>